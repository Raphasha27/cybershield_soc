@if (currentView() === 'landing') {
<nav class="premium-nav">
  <div class="logo">
    <div class="logo-icon">üõ°</div>CYBERSHIELD
  </div>
  <ul class="nav-links">
    <li><button (click)="setView('landing')">Protection</button></li>
    <li><button (click)="setView('checkup')">Checkup</button></li>
    <li><button (click)="setView('login')">Operator Portal</button></li>
  </ul>
  <div class="nav-status">
    <div class="status-dot"></div>ALL SHIELDS ACTIVE
  </div>
</nav>

<section class="landing-page">
  <div class="hero-section">
    <div class="hero-left">
      <div class="badge">
        <div class="status-dot"></div>TOTAL PROTECTION ACTIVE ‚Äî 6 SHIELDS ENABLED
      </div>
      <h1>
        <div class="solid">TOTAL</div>
        <div class="outline">CYBER</div>
        <div class="solid">DEFENSE</div>
      </h1>
      <p class="hero-desc">CyberShield wraps your digital life in six layers of protection ‚Äî blocking malware,
        ransomware, phishing, harmful ads, trackers, and zero-day exploits before they ever reach you. Powered by Neural
        Engine v3.0.</p>

      <div class="pillars">
        <div class="pillar">
          <div class="pillar-icon">ü¶†</div>
          <div class="pillar-title">Malware Defense</div>
          <div class="pillar-desc">Signatures + heuristic AI stops viruses & trojans instantly.</div>
        </div>
        <div class="pillar">
          <div class="pillar-icon">üö´</div>
          <div class="pillar-title">Ad & Tracker Block</div>
          <div class="pillar-desc">Eliminates harmful ads & pop-ups.</div>
        </div>
        <div class="pillar">
          <div class="pillar-icon">üîí</div>
          <div class="pillar-title">Ransomware Shield</div>
          <div class="pillar-desc">Stops file encryption attacks dead.</div>
        </div>
        <div class="pillar">
          <div class="pillar-icon">üé£</div>
          <div class="pillar-title">Anti-Phishing</div>
          <div class="pillar-desc">Detects fake login pages & scam emails.</div>
        </div>
        <div class="pillar">
          <div class="pillar-icon">üåê</div>
          <div class="pillar-title">WAF Protection</div>
          <div class="pillar-desc">Stops SQLi & XSS in under 1ms.</div>
        </div>
        <div class="pillar">
          <div class="pillar-icon">üïµÔ∏è</div>
          <div class="pillar-title">Dark Web Monitor</div>
          <div class="pillar-desc">Alerts you the moment your data surfaces.</div>
        </div>
      </div>

      <div class="stats-bar">
        <div><span class="stat-num">4.2M+</span><span class="stat-label">Threats Blocked Today</span></div>
        <div><span class="stat-num">99.97%</span><span class="stat-label">Detection Rate</span></div>
        <div><span class="stat-num">&lt;12ms</span><span class="stat-label">Response Time</span></div>
        <div class="ml-status-inline">
          <span class="stat-num">üß† {{ mlStatus().confidence }}%</span>
          <span class="stat-label">AI Confidence</span>
        </div>
      </div>

      <div class="ticker-bar">
        <span class="ticker-label">LIVE THREATS</span>
        <div class="ticker-wrap">
          <div class="ticker-scroll">
            <span class="ticker-item">Ransomware payload blocked ‚Äî <span>User: JSmith</span></span>
            <span class="ticker-item">Phishing domain flagged ‚Äî <span>secure-paypa1.com</span></span>
            <span class="ticker-item">Malvertising ad killed ‚Äî <span>Casino popup network</span></span>
            <span class="ticker-item">SQL Injection stopped ‚Äî <span>POST /api/login</span></span>
            <span class="ticker-item">Cryptominer terminated ‚Äî <span>PID 3840</span></span>
            <span class="ticker-item">DDoS flood mitigated ‚Äî <span>22,000 req/s</span></span>
            <!-- Duplicated for seamless loop -->
            <span class="ticker-item">Ransomware payload blocked ‚Äî <span>User: JSmith</span></span>
            <span class="ticker-item">Phishing domain flagged ‚Äî <span>secure-paypa1.com</span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- AUTH PANEL (Integrated Signup/Login for Landing) -->
    <div class="auth-panel">
      <div class="corner c-tl"></div>
      <div class="corner c-tr"></div>
      <div class="corner c-bl"></div>
      <div class="corner c-br"></div>
      <div class="panel-inner">
        <div class="tab-nav">
          <button class="tab-btn active" (click)="setView('login')">LOGIN</button>
          <button class="tab-btn" (click)="getStarted()">GET STARTED</button>
        </div>

        <div class="panel-content">
          <div class="panel-title">SECURE OPERATOR ACCESS</div>
          <p class="panel-sub">Authorize to enter the CyberShield SOC Terminal.</p>

          <button class="btn-primary" (click)="setView('login')">LOG IN TO DASHBOARD</button>

          <div class="divider">
            <div class="div-line"></div><span class="div-text">OR</span>
            <div class="div-line"></div>
          </div>

          <button class="btn-outline" (click)="getStarted()">CREATE PARTNER ACCOUNT</button>

          <div class="sec-badges">
            <div class="sec-badge">AES-256</div>
            <div class="sec-badge">SOC-2</div>
            <div class="sec-badge">ISO 27001</div>
            <div class="sec-badge">GDPR</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PROTECTION MODULES SECTION (REPLACING OLD FEATURES) -->
  <div class="section-wrap section-divider" id="protection">
    <div class="section-sub">Active Defense Engine</div>
    <div class="section-title">SECURITY ARCHITECTURE</div>
    <div class="modules-grid">
      <div class="module-card" style="--mc:#00ff88;">
        <div class="module-header">
          <div class="module-icon">ü¶†</div><button class="module-toggle"
            onclick="this.classList.toggle('off')"></button>
        </div>
        <div class="module-name">Layer 1</div>
        <div class="module-title">MALWARE PROTECTION</div>
        <div class="module-desc">Signature scanning + behavioral AI catches viruses & trojans before execution.</div>
        <div class="module-stat">
          <div>
            <div class="m-stat-val" style="color:#00ff88;">847K</div>
            <div class="m-stat-lbl">Blocked</div>
          </div>
          <div>
            <div class="m-stat-val" style="color:var(--accent2);font-size:15px;">ACTIVE</div>
            <div class="m-stat-lbl">Status</div>
          </div>
        </div>
      </div>
      <div class="module-card" style="--mc:#ff3c3c;">
        <div class="module-header">
          <div class="module-icon">üîí</div><button class="module-toggle"
            onclick="this.classList.toggle('off')"></button>
        </div>
        <div class="module-name">Layer 2</div>
        <div class="module-title">RANSOMWARE SHIELD</div>
        <div class="module-desc">Stops mass encryption dead and restores from shadow backups automatically.</div>
        <div class="module-stat">
          <div>
            <div class="m-stat-val" style="color:#ff3c3c;">12,400</div>
            <div class="m-stat-lbl">Stopped</div>
          </div>
          <div>
            <div class="m-stat-val" style="color:var(--accent2);font-size:15px;">ACTIVE</div>
            <div class="m-stat-lbl">Status</div>
          </div>
        </div>
      </div>
      <div class="module-card" style="--mc:#00d4ff;">
        <div class="module-header">
          <div class="module-icon">üî•</div><button class="module-toggle"
            onclick="this.classList.toggle('off')"></button>
        </div>
        <div class="module-name">Layer 3</div>
        <div class="module-title">NEXT-GEN WAF</div>
        <div class="module-desc">Blocks SQL injections, XSS, and path traversal in under 1ms.</div>
        <div class="module-stat">
          <div>
            <div class="m-stat-val" style="color:#00d4ff;">2.1M</div>
            <div class="m-stat-lbl">Filtered</div>
          </div>
          <div>
            <div class="m-stat-val" style="color:var(--accent2);font-size:15px;">ACTIVE</div>
            <div class="m-stat-lbl">Status</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="landing-footer">
    <div class="footer-logo">üõ° CYBERSHIELD SOC</div>
    <div class="footer-text">Built by Kivoc Dynamic Technology | v4.2.1 ‚Äî Neural Matrix</div>
    <div style="font-family:var(--font-mono);font-size:9px;color:var(--accent2); margin-top:5px;">‚óè TEST ENVIRONMENT
      ONLY ‚Äî RESEARCH PURPOSES</div>
  </footer>
</section>
}

@if (currentView() === 'login') {
<section class="login-page">
  <div class="auth-panel">
    <div class="corner c-tl"></div>
    <div class="corner c-tr"></div>
    <div class="corner c-bl"></div>
    <div class="corner c-br"></div>
    <div class="panel-inner">
      <div class="panel-title">SECURE ACCESS</div>
      <p class="panel-sub">Sign in to your protection dashboard.</p>

      <div class="form-group">
        <label>Operator ID / Email</label>
        <input type="email" #emailInput value="admin@cybershield.so" placeholder="admin@cybershield.so">
      </div>
      <div class="form-group">
        <label>Security Protocol / Password</label>
        <input type="password" #passInput value="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" placeholder="Enter password">
      </div>

      <button class="btn-primary" [disabled]="isLoginLoading()" (click)="login(emailInput.value, passInput.value)">
        @if (isLoginLoading()) {
        <span class="loader"></span> AUTHENTICATING...
        } @else {
        AUTHENTICATE & ACCESS SOC
        }
      </button>

      <div class="sec-badges">
        <div class="sec-badge">RSA-4096</div>
        <div class="sec-badge">TLS 1.3</div>
        <div class="sec-badge">MFA REQUIRED</div>
      </div>

      <div style="text-align:center;margin-top:20px;">
        <button class="btn-outline small" (click)="setView('landing')">RETURN TO PERIMETER</button>
      </div>
    </div>
  </div>
</section>
}

@if (currentView() === 'get-started') {
<section class="login-page animate-fade">
  <div class="auth-panel">
    <div class="corner c-tl"></div>
    <div class="corner c-tr"></div>
    <div class="corner c-bl"></div>
    <div class="corner c-br"></div>
    <div class="panel-inner">
      <div class="panel-title">SYSTEM PROVISIONING</div>
      <p class="panel-sub">Initialize your 'Total Cyber Defense' node.</p>

      <div class="form-group">
        <label>Organization Name</label>
        <input type="text" placeholder="e.g. Kivoc Dynamic Tech">
      </div>
      <div class="form-group">
        <label>Primary Operator Email</label>
        <input type="email" placeholder="admin@kivoc.tech">
      </div>
      <div class="form-group">
        <label>Neural Shield Pin</label>
        <input type="password" placeholder="6-digit security pin">
      </div>

      <button class="btn-primary" (click)="setView('login')">
        INITIALIZE & ACTIVATE PROTECTIONS
      </button>

      <div style="text-align:center; margin-top:20px;">
        <button class="btn-outline small" (click)="setView('landing')">RETURN TO PERIMETER</button>
      </div>
    </div>
  </div>
</section>
}

@if (isLoggedIn()) {
<!-- Existing authenticated content -->
<!-- HEADER -->
<header class="header">
  <div class="header-content">

    <!-- Logo -->
    <div class="logo-section">
      <div class="logo-icon-wrap" (click)="setView('landing')" style="cursor:pointer">
        <span class="logo-icon">‚¨°</span>
        <span class="logo-pulse"></span>
      </div>
      <div class="logo-text">
        <h1>CyberShield</h1>
        <span class="logo-subtitle">Security Operations Center</span>
      </div>
    </div>

    <!-- Nav -->
    <nav class="main-nav" role="navigation" aria-label="Main navigation">
      @for (item of navItems; track item.id) {
      <button class="nav-btn" [class.active]="currentView() === item.id" (click)="setView(item.id)"
        [attr.aria-current]="currentView() === item.id ? 'page' : null" [id]="'nav-' + item.id">
        <span class="nav-icon">{{ item.icon }}</span>
        <span class="nav-label">{{ item.label }}</span>
        @if (item.id === 'darknet') {
        <span class="nav-badge darknet">{{ darknetFeed().length }}</span>
        }
      </button>
      }
    </nav>

    <!-- Actions -->
    <div class="header-actions">
      <div class="search-bar" [class.focused]="isSearchFocused()">
        <span class="search-icon-left">‚¨°</span>
        <input id="global-search" type="text" placeholder="Search threats, incidents..." (keyup.enter)="search($event)"
          (focus)="isSearchFocused.set(true)" (blur)="isSearchFocused.set(false)">
      </div>

      <button id="alert-panel-btn" class="icon-btn" [class.active]="isAlertPanelOpen()" (click)="toggleAlertPanel()"
        title="Security Alerts">
        <span class="icon-btn-icon">üîî</span>
        @if (notifications().length > 0) {
        <span class="badge-count">{{ notifications().length }}</span>
        }
      </button>

      <button id="ai-panel-btn" class="icon-btn ai-btn" [class.active]="isAIPanelOpen()" (click)="toggleAI()"
        title="CyberSentinel AI">
        <span class="ai-btn-glow"></span>
        <span class="icon-btn-icon">‚óà</span>
      </button>

      <div class="profile-group">
        <button id="profile-btn" class="user-profile-btn" (click)="toggleProfileModal()">
          <div class="user-profile">
            <div class="user-avatar">{{ adminProfile().name.charAt(0) }}</div>
            <div class="user-info">
              <span class="user-name">{{ adminProfile().name }}</span>
              <span class="user-role">{{ adminProfile().role }}</span>
            </div>
          </div>
        </button>
        <button class="logout-btn" (click)="logout()" title="Logout"> Logout </button>
      </div>
    </div>

  </div>

  <!-- Threat Banner -->
  <div class="threat-banner" [class.critical-mode]="threatLevel() > 80">
    <div class="threat-banner-inner">
      <div class="threat-level-info">
        <span class="threat-label">THREAT LEVEL</span>
        <span class="threat-status-text" [class.critical]="threatLevel() > 80"
          [class.elevated]="threatLevel() > 60 && threatLevel() <= 80">
          {{ threatLevel() > 80 ? 'CRITICAL' : (threatLevel() > 60 ? 'ELEVATED' : 'MODERATE') }}
        </span>
        <span class="threat-percent">{{ threatLevel().toFixed(1) }}%</span>
      </div>
      <div class="threat-gauge-bar">
        <div class="gauge-fill" [style.width.%]="threatLevel()" [class.high]="threatLevel() > 80"
          [class.medium]="threatLevel() > 60 && threatLevel() <= 80">
        </div>
      </div>
      <div class="threat-meta">
        <span class="threat-ai-label">‚óà AI Heuristic Engine Active</span>
        <button class="action-btn primary small" (click)="setView('threats')" id="banner-view-threats">View
          Threats</button>
      </div>
    </div>
  </div>
</header>

<!-- MAIN CONTENT -->
<main class="main-content">
  @if (currentView() === 'dashboard') {
  <section class="view" id="view-dashboard">
    <!-- Metric Cards -->
    <div class="metrics-grid">
      <div class="metric-card critical" (click)="setView('threats')" id="metric-critical-alerts" tabindex="0"
        role="button">
        <div class="metric-card-bg"></div>
        <div class="metric-header">
          <span class="metric-icon">‚óâ</span>
          <h4>Critical Alerts</h4>
        </div>
        <div class="metric-value">
          <span class="value">{{ displayedCriticalAlerts() }}</span>
          <span class="trend up">+12%</span>
        </div>
        <div class="metric-footer"><span class="metric-label">Last 24 hours</span></div>
        <div class="metric-glow g-critical"></div>
      </div>

      <div class="metric-card warning" (click)="setView('incidents')" id="metric-active-incidents" tabindex="0"
        role="button">
        <div class="metric-card-bg"></div>
        <div class="metric-header">
          <span class="metric-icon">‚óé</span>
          <h4>Active Incidents</h4>
        </div>
        <div class="metric-value">
          <span class="value">{{ displayedActiveIncidents() }}</span>
          <span class="trend down">-8%</span>
        </div>
        <div class="metric-footer"><span class="metric-label">Requiring attention</span></div>
        <div class="metric-glow g-warning"></div>
      </div>

      <div class="metric-card info" (click)="setView('vulnerabilities')" id="metric-vulnerabilities" tabindex="0"
        role="button">
        <div class="metric-card-bg"></div>
        <div class="metric-header">
          <span class="metric-icon">‚óá</span>
          <h4>Vulnerabilities</h4>
        </div>
        <div class="metric-value">
          <span class="value">{{ displayedVulnerabilities() }}</span>
          <span class="trend up">+5%</span>
        </div>
        <div class="metric-footer"><span class="metric-label">Unpatched systems</span></div>
        <div class="metric-glow g-info"></div>
      </div>

      <div class="metric-card success" (click)="setView('compliance')" id="metric-systems-protected" tabindex="0"
        role="button">
        <div class="metric-card-bg"></div>
        <div class="metric-header">
          <span class="metric-icon">‚óÜ</span>
          <h4>Systems Protected</h4>
        </div>
        <div class="metric-value">
          <span class="value">{{ displayedSystemsProtected().toLocaleString() }}</span>
          <span class="trend neutral">0%</span>
        </div>
        <div class="metric-footer"><span class="metric-label">Network endpoints</span></div>
        <div class="metric-glow g-success"></div>
      </div>
    </div>

    <!-- Charts Row -->
    <div class="charts-grid">

      <!-- Threat Timeline -->
      <div class="chart-card large">
        <div class="card-header">
          <h3>Threat Activity Timeline</h3>
          <div class="chart-controls">
            @for (r of ['24H', '7D', '30D']; track r) {
            <button class="btn-outline small" [class.active]="chartTimeRange() === r" (click)="setChartRange(r)"
              style="width:auto; padding:4px 10px;">{{ r }}</button>
            }
          </div>
        </div>
        <div class="chart-container">
          <canvas id="threatTimelineChart"></canvas>
        </div>
      </div>

      <!-- SYSTEM CHECKUP PROMO CARD -->
      <div class="card promo-card"
        style="padding:24px; display:flex; flex-direction:column; justify-content:center; gap:20px; border-color:var(--accent);">
        <div class="promo-content" style="display:flex; gap:15px; align-items:center;">
          <span class="p-icon" style="font-size:32px;">üîç</span>
          <div class="p-text">
            <h4
              style="font-family:var(--font-display); font-size:1.4rem; color:white; letter-spacing:1px; margin-bottom:4px;">
              NEURAL INTEGRITY</h4>
            <p style="font-size:12px; color:var(--muted);">Deep web breach detection.</p>
          </div>
        </div>
        <button class="btn-primary small full-width" (click)="setView('checkup')">RUN SCAN</button>
      </div>

      <!-- Threat Distribution Donut -->
      <div class="chart-card medium">
        <div class="card-header">
          <h3>Threat Distribution</h3>
        </div>
        <div class="chart-container">
          <canvas id="threatDistChart"></canvas>
        </div>
      </div>

    </div>

    <!-- Dual Section -->
    <div class="dual-section">

      <!-- Recent Incidents -->
      <div class="section-card">
        <div class="card-header">
          <h3>Recent Security Incidents</h3>
          <button class="view-all-btn" (click)="setView('incidents')" id="btn-view-all-incidents">View All ‚Üí</button>
        </div>
        <div class="incidents-list">
          @for (inc of incidents().slice(0, 5); track inc.id) {
          <div class="incident-item" [class]="inc.severity" (click)="openIncident(inc)" tabindex="0" role="button">
            <div class="incident-header">
              <span class="incident-title">{{ inc.type }}</span>
              <span class="incident-time">{{ inc.time }}</span>
            </div>
            <p class="incident-description">{{ inc.id }} ‚Äî {{ inc.description | slice:0:80 }}...</p>
            @if (inc.assignee) {
            <span class="incident-assignee">üë§ {{ inc.assignee }}</span>
            }
          </div>
          }
        </div>
      </div>

      <!-- Network Traffic -->
      <div class="section-card">
        <div class="card-header">
          <h3>Network Traffic Monitor</h3>
          <span class="live-indicator"><span class="live-dot"></span>LIVE</span>
        </div>
        <div class="traffic-visualization">
          <canvas id="networkTrafficChart"></canvas>
        </div>
        <div class="traffic-stats">
          <div class="stat-item">
            <span class="stat-label">Inbound</span>
            <span class="stat-value">2.4 GB/s</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Outbound</span>
            <span class="stat-value">1.8 GB/s</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Blocked</span>
            <span class="stat-value" style="color: var(--color-danger)">347 MB/s</span>
          </div>
        </div>
      </div>

    </div>

    <!-- Attack Sources + Terminal -->
    <div class="dual-section">

      <!-- Attack Sources -->
      <div class="section-card">
        <div class="card-header"
          style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
          <h3 style="font-family:var(--font-display); font-size:1.4rem; color:white; letter-spacing:1px;">TOP ATTACK
            SOURCES</h3>
          <div class="nav-status">
            <div class="status-dot"></div> LIVE
          </div>
        </div>
        <div class="attack-sources">
          @for (src of attackSources(); track src.country) {
          <div class="source-item" style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
            <span class="country-flag">{{ src.flag }}</span>
            <span class="country-name"
              style="flex:1; font-family:var(--font-mono); font-size:11px; color:var(--muted);">{{
              src.country.toUpperCase() }}</span>
            <div class="progress-bar-bg" style="width:100px; height:4px; flex-shrink:0;">
              <div class="progress-bar-fill" [style.width.%]="src.percent"></div>
            </div>
            <span class="source-count" style="font-family:var(--font-mono); font-size:10px; color:var(--accent);">{{
              src.count.toLocaleString() }}</span>
          </div>
          }
        </div>
      </div>

      <!-- Live Log Terminal -->
      <div class="terminal-card">
        <div class="terminal-header" style="background:rgba(255,255,255,0.03); padding:10px 15px;">
          <div class="terminal-controls">
            <span class="control-dot red"></span>
            <span class="control-dot yellow"></span>
            <span class="control-dot green"></span>
          </div>
          <div class="terminal-title"
            style="font-family:var(--font-mono); font-size:9px; color:var(--muted); letter-spacing:1px;">
            CYBERSHIELD_SIEM_v4.2</div>
          <div class="nav-status">
            <div class="status-dot"></div> LIVE_FEED
          </div>
        </div>
        <div class="terminal-body" #systemTerminal>
          @if (logs().length === 0) {
          <div class="log-line"><span class="log-timestamp">[--:--:--]</span><span class="log-tag info">INFO</span><span
              class="log-message">Initialising SIEM event stream...</span></div>
          }
          @for (log of logs(); track log.timestamp + log.msg) {
          <div class="log-line">
            <span class="log-timestamp">[{{ log.timestamp }}]</span>
            <span class="log-tag" [class]="log.level">{{ log.level.toUpperCase() }}</span>
            @if (log.source) {
            <span class="log-source">{{ log.source }}</span>
            }
            <span class="log-message">{{ log.msg }}</span>
          </div>
          }
        </div>
      </div>

    </div>
  </section>
  }

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         THREATS VIEW
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  @if (currentView() === 'threats') {
  <section class="view animate-fade" id="view-threats">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Real-Time Intel</div>
        <h2>THREAT INTELLIGENCE CENTER</h2>
      </div>
      <div class="header-actions">
        <span class="nav-status" style="margin-right:15px;">
          <div class="status-dot"></div> {{ threats().length }} ACTIVE THREATS
        </span>
        <button class="btn-primary small" (click)="showToast('Refreshing threat feed...','info','üì°')"
          id="btn-refresh-threats">REFRESH FEED</button>
      </div>
    </div>

    <div class="card overflow-hidden">
      <div class="threats-table-container">
        <table class="threats-table" aria-label="Active Threats">
          <thead>
            <tr>
              <th>THREAT ID</th>
              <th>TYPE</th>
              <th>SEVERITY</th>
              <th>SOURCE</th>
              <th>VECTOR</th>
              <th>DETECTED</th>
              <th>STATUS</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody>
            @for (threat of threats(); track threat.id) {
            <tr>
              <td class="threat-id-cell">{{ threat.id }}</td>
              <td>{{ threat.type }}</td>
              <td><span class="severity-badge" [class]="threat.severity">{{ threat.severity }}</span></td>
              <td class="mono-cell" style="font-size:11px;">{{ threat.source }}</td>
              <td class="mono-cell small-text" style="opacity:0.7;">{{ threat.attackVector }}</td>
              <td class="mono-cell small-text">{{ threat.detected }}</td>
              <td><span class="status-badge" [class]="threat.status.toLowerCase()">{{ threat.status }}</span></td>
              <td><button class="btn-outline small" (click)="performThreatAction(threat)"
                  [id]="'action-' + threat.id">ANALYSE</button></td>
            </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </section>
  }

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         INCIDENTS ‚Äî KANBAN
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  @if (currentView() === 'incidents') {
  <section class="view animate-fade" id="view-incidents">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Response Lifecycle</div>
        <h2>INCIDENT ORCHESTRATION</h2>
      </div>
      <div class="nav-status">
        <div class="status-dot"></div> {{ incidents().length }} TOTAL CASES
      </div>
    </div>

    <div class="incidents-kanban">
      @for (status of ['detected', 'investigating', 'containing', 'resolved']; track status) {
      <div class="kanban-column">
        <div class="column-header" [class]="status">
          <div class="column-title">
            <div class="status-dot"></div>
            <h4>{{ status.toUpperCase() }}</h4>
          </div>
          <span class="count">{{ getIncidentsByStatus(status).length }}</span>
        </div>
        <div class="column-body">
          @for (inc of getIncidentsByStatus(status); track inc.id) {
          <div class="kanban-card" [class]="inc.severity">
            <div (click)="openIncident(inc)" style="cursor:pointer">
              <div class="kanban-card-header">
                <span class="kanban-card-id">{{ inc.id }}</span>
                <span class="severity-badge" [class]="inc.severity">{{ inc.severity }}</span>
              </div>
              <div class="kanban-card-title">{{ inc.type }}</div>
              <div class="kanban-card-time" style="font-family:var(--font-mono); font-size:9px;">{{ inc.time }}</div>
            </div>
            <div class="kanban-card-actions">
              @if (status === 'detected') {
              <button class="btn-outline small full-width"
                (click)="updateIncidentStatus(inc.id, 'investigating')">INVESTIGATE ‚Üí</button>
              }
              @if (status === 'investigating') {
              <button class="btn-outline small" (click)="updateIncidentStatus(inc.id, 'containing')">CONTAIN ‚Üí</button>
              }
              @if (status === 'containing') {
              <button class="btn-outline small" (click)="updateIncidentStatus(inc.id, 'resolved')">RESOLVE ‚úì</button>
              }
            </div>
          </div>
          }
          @if (getIncidentsByStatus(status).length === 0) {
          <div class="kanban-empty">
            <div style="font-size:18px; margin-bottom:5px;">üõ°</div>
            <span>Perimeter Secure</span>
          </div>
          }
        </div>
      </div>
      }
    </div>
  </section>
  }

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         VULNERABILITIES VIEW
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  @if (currentView() === 'vulnerabilities') {
  <section class="view animate-fade" id="view-vulnerabilities">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Surface Analysis</div>
        <h2>VULNERABILITY ASSESSMENT</h2>
      </div>
      <div style="display:flex; align-items:center; gap:1.5rem;">
        @if (isScannerActive()) {
        <div class="scan-progress-wrap">
          <span class="scan-label">SCANNING MATRIX... {{ scanProgress().toFixed(0) }}%</span>
          <div class="scan-bar">
            <div class="scan-fill" [style.width.%]="scanProgress()"></div>
          </div>
        </div>
        }
        <button class="btn-primary" (click)="runScan()" [disabled]="isScannerActive()" id="btn-run-scan">
          {{ isScannerActive() ? 'ANALYSING...' : 'RUN FULL AUDIT' }}
        </button>
      </div>
    </div>

    <div class="vulnerabilities-list">
      @for (vuln of vulnerabilities(); track vuln.id) {
      <div class="vuln-item card" [class]="vuln.severity" style="padding:20px; margin-bottom:15px;">
        <div class="vuln-item-header"
          style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:12px;">
          <div>
            <h3 class="vuln-title"
              style="font-family:var(--font-display); font-size:1.4rem; color:white; letter-spacing:1px;">{{ vuln.title
              }}</h3>
            <span class="vuln-cve" style="font-family:var(--font-mono); font-size:10px; color:var(--accent);">{{ vuln.id
              }}</span>
          </div>
          <span class="severity-badge" [class]="vuln.severity">{{ vuln.severity }}</span>
        </div>
        <p class="vuln-description" style="font-size:13px; color:var(--muted); line-height:1.6; margin-bottom:15px;">{{
          vuln.description }}</p>
        <div class="vuln-footer" style="display:flex; gap:20px; font-family:var(--font-mono); font-size:11px;">
          <span>CVSS: <strong style="color: var(--warn)">{{ vuln.score }}</strong></span>
          <span>AFFECTED: <strong style="color:white">{{ vuln.systems }} NODES</strong></span>
          @if (vuln.patch) {
          <span>REMEDIATION: <strong style="color:var(--accent2)">{{ vuln.patch }}</strong></span>
          }
        </div>
      </div>
      }
    </div>
  </section>
  }

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         DARKNET MONITOR VIEW (NEW)
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  @if (currentView() === 'darknet') {
  <section class="view animate-fade" id="view-darknet">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Deep Web Reconnaissance</div>
        <h2>DARKNET MONITOR</h2>
      </div>
      <div class="header-actions">
        <span class="darknet-live-badge" style="margin-right:15px;">
          <div class="status-dot"></div> MONITORING ACTIVE
        </span>
        <button class="btn-primary small" (click)="showToast('Scanning darknet sources...','info','üëÅ')"
          id="btn-darknet-scan">REFRESH INTEL</button>
      </div>
    </div>

    <div class="darknet-alert-banner">
      <div class="status-dot" style="background:var(--warn); box-shadow:0 0 10px var(--warn);"></div>
      <div>
        <strong style="color:var(--warn); font-family:var(--font-mono);">{{ criticalDarknetCount() }} CRITICAL
          THREATS</strong> detected across global marketplaces. Identity integrity risks identified on node JHB-772.
      </div>
    </div>

    <div class="darknet-grid">
      @for (item of darknetFeed(); track item.id) {
      <div class="darknet-card card" [class]="item.risk" style="padding:20px;">
        <div class="darknet-card-header"
          style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:15px;">
          <div class="darknet-card-meta">
            <span class="darknet-id"
              style="font-family:var(--font-mono); font-size:10px; color:var(--accent); display:block;">{{ item.id
              }}</span>
            <span class="darknet-type-badge"
              style="font-family:var(--font-mono); font-size:9px; color:var(--muted); text-transform:uppercase;">{{
              item.type }}</span>
          </div>
          <span class="status-badge" [class]="item.status">{{ item.status.toUpperCase() }}</span>
        </div>
        <p class="darknet-description" style="font-size:12px; color:var(--text); line-height:1.5; margin-bottom:15px;">
          {{ item.description }}</p>
        <div class="darknet-card-footer"
          style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
          <span class="darknet-time" style="font-family:var(--font-mono); font-size:9px; color:var(--muted);">‚è± {{
            item.discovered }}</span>
          <span class="severity-badge" [class]="item.risk" style="font-size:9px;">{{ item.risk }}</span>
        </div>
        <button class="btn-primary small full-width"
          (click)="showToast('Tracking item ' + item.id + '...', 'warning', 'üëÅ')" [id]="'darknet-action-' + item.id">
          INITIATE TAKEDOWN
        </button>
      </div>
      }
    </div>
  </section>
  }

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         COMPLIANCE VIEW
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  @if (currentView() === 'compliance') {
  <section class="view animate-fade" id="view-compliance">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Governance Monitor</div>
        <h2>REGULATORY COMPLIANCE</h2>
      </div>
      <div class="header-actions">
        <button class="btn-primary" (click)="generateReport()">GENERATE AUDIT REPORT</button>
      </div>
    </div>

    <div class="compliance-grid">
      @for (item of complianceFrameworks(); track item.name) {
      <div class="compliance-card card" style="padding:24px;">
        <div class="comp-header"
          style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
          <h3 style="font-family:var(--font-display); font-size:1.6rem; color:white; letter-spacing:1px;">{{ item.name
            }}</h3>
          <span class="comp-score" [class.high]="item.score >= 90" [class.med]="item.score >= 80"
            [class.low]="item.score < 80" style="font-family:var(--font-display); font-size:1.4rem;">
            {{ item.score }}%
          </span>
        </div>
        <div class="progress-bar-bg" style="height:6px; margin-bottom:15px;">
          <div class="progress-bar-fill" [style.width.%]="item.score"
            [style.background]="item.score >= 90 ? 'var(--accent2)' : (item.score >= 80 ? 'var(--accent)' : 'var(--warn)')">
          </div>
        </div>
        <div class="comp-details" style="font-family:var(--font-mono); font-size:11px; color:var(--muted);">
          <div style="color:white; margin-bottom:4px;">{{ item.passed }} / {{ item.controls }} CONTROLS PASSED</div>
          <div [style.color]="item.score >= 90 ? 'var(--accent2)' : 'var(--muted)'">{{ item.status.toUpperCase() }}
          </div>
        </div>
      </div>
      }
    </div>
  </section>
  }

  <!-- ENTERPRISE HUB VIEW -->
  @if (currentView() === 'enterprise') {
  <section class="view animate-fade" id="view-enterprise">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Global Asset Management</div>
        <h2>ENTERPRISE DEVICE HUB</h2>
      </div>
      <div class="nav-status">
        <div class="status-dot"></div> {{ fleetStatus().activeDrivers }} DRIVERS PROTECTED
      </div>
    </div>

    <div class="metrics-grid">
      <div class="metric-card info">
        <div class="metric-header">
          <h4>Fleet Coverage</h4>
        </div>
        <div class="metric-value"><span class="value">{{ fleetStatus().globalCoverage }}</span></div>
        <p style="font-size:11px; color:var(--muted); margin-top:5px;">Real-time GPS security tracking active.</p>
      </div>
      <div class="metric-card warning">
        <div class="metric-header">
          <h4>Safety Alerts</h4>
        </div>
        <div class="metric-value"><span class="value">{{ fleetStatus().safetyAlerts }}</span></div>
        <p style="font-size:11px; color:var(--muted); margin-top:5px;">Potential route deviations detected.</p>
      </div>
    </div>

    <div class="grid-2-1" style="display:grid; grid-template-columns: 2fr 1fr; gap:24px; margin-top:24px;">
      <div class="card overflow-hidden">
        <div class="card-header" style="padding:20px; border-bottom:1px solid var(--border);">
          <h3 style="font-family:var(--font-display); font-size:1.2rem; color:white;">Global Device Matrix</h3>
        </div>
        <div class="table-wrap">
          <table class="threats-table">
            <thead>
              <tr>
                <th>ASSET ID</th>
                <th>DEVICE</th>
                <th>USER/DRIVER</th>
                <th>LAT/LNG</th>
                <th>STATUS</th>
                <th>SYNC</th>
              </tr>
            </thead>
            <tbody>
              @for (dev of enterpriseDevices(); track dev.id) {
              <tr>
                <td class="mono-cell" style="color:var(--accent);">{{ dev.id }}</td>
                <td>{{ dev.name }} ({{ dev.type }})</td>
                <td>{{ dev.user }}</td>
                <td class="mono-cell" style="font-size:10px;">{{ dev.location?.lat?.toFixed(4) }}, {{
                  dev.location?.lng?.toFixed(4) }}</td>
                <td><span class="status-badge" [class]="dev.status">{{ dev.status.toUpperCase() }}</span></td>
                <td style="font-size:11px; color:var(--muted);">{{ dev.lastSync }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>
      </div>

      <div class="card" style="padding:20px;">
        <h3 style="font-family:var(--font-display); font-size:1.2rem; color:white; margin-bottom:15px;">Safety Monitor
        </h3>
        <div class="safety-log" style="font-family:var(--font-mono); font-size:11px; color:var(--muted);">
          <div
            style="margin-bottom:10px; padding:10px; background:rgba(255,140,0,0.05); border-left:2px solid var(--orange);">
            <div style="color:var(--orange);">ALERT: JHB-Fleet-02</div>
            <div>Driver safety at risk. Deviation detected in Bramley area. Monitoring neural pulse...</div>
          </div>
          <div
            style="margin-bottom:10px; padding:10px; background:rgba(0,212,255,0.05); border-left:2px solid var(--accent);">
            <div>CPT-Fleet-04</div>
            <div>Asset secured. Route integrity 100%.</div>
          </div>
        </div>
      </div>
    </div>
  </section>
  }

  <!-- NEURAL SHIELD VIEW -->
  @if (currentView() === 'comm-shield') {
  <section class="view animate-fade" id="view-comm-shield">
    <div class="view-header">
      <div class="header-main">
        <div class="section-sub">Communication Intercept</div>
        <h2>NEURAL COMMUNICATION SHIELD</h2>
      </div>
      <div class="nav-status">
        <div class="status-dot"></div> AI AGENT ACTIVE
      </div>
    </div>

    <div class="card"
      style="margin-bottom:24px; padding:30px; text-align:center; background:radial-gradient(circle at center, rgba(155, 89, 255, 0.05), transparent);">
      <div style="font-size:48px; margin-bottom:15px;">üë§</div>
      <h3 style="font-family:var(--font-display); font-size:2rem; color:white; letter-spacing:2px;">IDENTITY PROTECTOR
      </h3>
      <p style="color:var(--muted); max-width:600px; margin:0 auto;">CyberShield AI is actively intercepting harmful
        emails, robocalls, and smishing attacks before they reach your operators. 14,000+ signatures updated this hour.
      </p>
    </div>

    <div class="grid-2" style="display:grid; grid-template-columns: 1fr 1fr; gap:24px;">
      <div class="card">
        <div class="card-header" style="padding:20px; border-bottom:1px solid var(--border);">
          <h3 style="font-family:var(--font-display); color:white;">Harmful Comm Blocked</h3>
        </div>
        @for (alert of commShieldAlerts(); track alert.id) {
        <div
          style="padding:15px; border-bottom:1px solid rgba(255,255,255,0.03); display:flex; justify-content:space-between; align-items:center;">
          <div>
            <div style="font-family:var(--font-mono); font-size:11px; color:var(--accent);">{{ alert.source }}</div>
            <div style="font-size:13px; color:white; margin:4px 0;">{{ alert.threatDescription }}</div>
            <div style="font-size:9px; color:var(--muted);">{{ alert.timestamp }} ‚Ä¢ TYPE: {{ alert.type.toUpperCase() }}
            </div>
          </div>
          <span class="status-badge" [class]="alert.actionTaken">{{ alert.actionTaken.toUpperCase() }}</span>
        </div>
        }
      </div>

      <div class="card" style="padding:20px;">
        <h3 style="font-family:var(--font-display); color:white; margin-bottom:15px;">Spam/Fraud Database</h3>
        <div style="display:flex; flex-direction:column; gap:10px;">
          <div
            style="padding:12px; background:rgba(255,255,255,0.02); border-radius:6px; font-size:12px; display:flex; justify-content:space-between;">
            <span>Robocal IDs</span> <span style="color:var(--warn);">24,882 Known</span>
          </div>
          <div
            style="padding:12px; background:rgba(255,255,255,0.02); border-radius:6px; font-size:12px; display:flex; justify-content:space-between;">
            <span>Phishing Domains</span> <span style="color:var(--warn);">112,400 Known</span>
          </div>
          <div
            style="padding:12px; background:rgba(255,255,255,0.02); border-radius:6px; font-size:12px; display:flex; justify-content:space-between;">
            <span>AI Block Success Rate</span> <span style="color:var(--accent2);">99.98%</span>
          </div>
        </div>
      </div>
    </div>
  </section>
  }

  <!-- SYSTEM CHECKUP VIEW (PREMIUM) -->
  @if (currentView() === 'checkup') {
  <section class="view animate-fade" id="view-checkup">
    <div class="section-wrap">
      <div class="section-sub">Identity Integrity Scan</div>
      <div class="section-title">NEURAL SYSTEM CHECKUP</div>

      <div class="scan-container">
        <div class="scan-body">
          <div class="scan-input-area">
            <div class="results-title">SCAN PARAMETERS</div>
            <div class="scan-types">
              <div class="scan-type selected" (click)="showToast('Email scan active', 'info', 'üìß')">
                <div class="scan-check">‚úì</div>
                <div>
                  <div class="scan-type-name">EMAIL SCAN</div>
                  <div class="scan-type-sub">Checks credential dumps</div>
                </div>
              </div>
              <div class="scan-type selected" (click)="showToast('ID scan active', 'info', 'üÜî')">
                <div class="scan-check">‚úì</div>
                <div>
                  <div class="scan-type-name">ID VERIFICATION</div>
                  <div class="scan-type-sub">Identity cross-reference</div>
                </div>
              </div>
              <div class="scan-type selected" (click)="showToast('Phone scan active', 'info', 'üì±')">
                <div class="scan-check">‚úì</div>
                <div>
                  <div class="scan-type-name">PHONE MONITOR</div>
                  <div class="scan-type-sub">SIM-swap & leak check</div>
                </div>
              </div>
              <div class="scan-type" (click)="showToast('Deep web scan available in Pro', 'warning', 'üåë')">
                <div class="scan-check"></div>
                <div>
                  <div class="scan-type-name">DEEP WEB SCAN</div>
                  <div class="scan-type-sub">Paid feature only</div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>Professional Email</label>
              <input type="email" placeholder="e.g. analyst@cybershield.so" [value]="checkupForm().email"
                (input)="updateCheckupForm('email', $event)">
            </div>

            <div class="scan-url-group">
              <div class="form-group" style="flex:1">
                <label>ID Number</label>
                <input type="text" placeholder="RSA ID / Passport" [value]="checkupForm().idNumber"
                  (input)="updateCheckupForm('idNumber', $event)">
              </div>
              <div class="form-group" style="flex:1">
                <label>Mobile Number</label>
                <input type="text" placeholder="+27 ..." [value]="checkupForm().phone"
                  (input)="updateCheckupForm('phone', $event)">
              </div>
            </div>

            <button class="btn-scan full-width" [disabled]="isSystemScanning()" (click)="runPersonalCheckup()">
              @if (isSystemScanning()) {
              <span class="loader"></span> ANALYSING ENTROPY...
              } @else {
              LAUNCH MULTI-LAYER SCAN
              }
            </button>

            @if (isSystemScanning()) {
            <div class="scan-progress">
              <div class="progress-header">
                <span class="progress-label">NEURAL MATRIX SEARCH</span>
                <span class="progress-pct">42%</span>
              </div>
              <div class="progress-bar-bg">
                <div class="progress-bar-fill" style="width: 42%"></div>
              </div>
              <div class="scan-log">
                <div class="log-line">Connecting to Node [JHB-772]... <span class="log-ok">OK</span></div>
                <div class="log-line">Parsing dump files (12.4 GB)... <span class="log-ok">OK</span></div>
                <div class="log-line">Running fuzzy match on email... <span class="log-info">SEARCHING</span></div>
                <div class="log-line">Cross-referencing global databases...</div>
                <div class="log-line">Anomaly detected on Cluster 4... <span class="log-warn">WARN</span></div>
              </div>
            </div>
            }
          </div>

          <div class="scan-results-area">
            <div class="scan-results">
              <div class="results-title">SCAN RESULTS</div>

              @if (checkupResults().length === 0 && !isSystemScanning()) {
              <div style="text-align:center;padding:40px 0;opacity:0.5;">
                <div style="font-size:30px;margin-bottom:10px;">üìã</div>
                <div class="result-name">WAITING FOR EXECUTION</div>
              </div>
              }

              @for (res of checkupResults(); track res.category) {
              <div class="result-item">
                <div>
                  <div class="result-name">{{ res.category }}</div>
                  <div class="footer-text" style="font-size:10px;">{{ res.lastChecked }}</div>
                </div>
                <div class="result-val" [class.val-safe]="res.status === 'clean'"
                  [class.val-warn]="res.status === 'warning'" [class.val-danger]="res.status === 'compromised'">
                  {{ res.status.toUpperCase() }}
                </div>
              </div>
              <div style="font-size:10px;color:var(--muted);margin-bottom:10px;padding-top:4px;">{{ res.message }}</div>
              }

              <div class="radar-wrapper">
                <div class="radar-label">NEURAL MATRIX STATUS</div>
                <div class="radar-scan" style="margin: 0 auto;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  }
</main>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       INCIDENT DETAIL MODAL
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
@if (isModalOpen()) {
<div class="modal-overlay active" (click)="closeModal()">
  <div class="modal-panel" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div>
        <span class="modal-id">{{ selectedIncident()?.id }}</span>
        <h3>{{ selectedIncident()?.type }}</h3>
      </div>
      <button class="close-btn" (click)="closeModal()" id="modal-close">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="modal-badges">
        <span class="severity-badge" [class]="selectedIncident()?.severity">{{ selectedIncident()?.severity }}</span>
        <span class="status-badge" [class]="selectedIncident()?.status">{{ selectedIncident()?.status }}</span>
      </div>
      <p class="modal-desc">{{ selectedIncident()?.description }}</p>
      @if (selectedIncident()?.assignee) {
      <p class="modal-assignee">üë§ Assigned to: <strong>{{ selectedIncident()?.assignee }}</strong></p>
      }
      <div class="modal-actions">
        <button class="action-btn primary" (click)="isolateSystem()" id="btn-isolate-system">üîí Isolate System</button>
        <button class="action-btn" (click)="escalateIncident()" id="btn-escalate">üì¢ Escalate</button>
      </div>
    </div>
  </div>
</div>
}

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       NOTIFICATION PANEL
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="notification-panel" [class.active]="isAlertPanelOpen()" id="notification-panel">
  <div class="panel-header">
    <h3>Security Alerts</h3>
    <button class="clear-btn" (click)="clearNotifications()" id="btn-clear-alerts">Clear All</button>
  </div>
  <div class="notifications-list">
    @for (note of notifications(); track note.id) {
    <div class="notification-item" [class]="note.type">
      <div class="notification-header">
        <span class="notification-icon">{{ note.type === 'critical' ? '‚¨°' : (note.type === 'warning' ? '‚óé' : '‚Ñπ')
          }}</span>
        <span class="notification-title">{{ note.title }}</span>
        @if (note.time) { <span class="notification-time">{{ note.time }}</span> }
      </div>
      <div class="notification-body">{{ note.message }}</div>
    </div>
    }
    @if (notifications().length === 0) {
    <div class="empty-notifications">‚úì No new alerts</div>
    }
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       AI ASSISTANT SIDEBAR
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="ai-sidebar" [class.active]="isAIPanelOpen()" id="ai-sidebar">
  <div class="ai-header">
    <div class="ai-title">
      <div class="ai-avatar">‚óà</div>
      <div>
        <h3>CyberSentinel AI</h3>
        <span class="ai-status">v3.0 ¬∑ Ready to assist</span>
      </div>
    </div>
    <button class="close-btn" (click)="toggleAI()" id="ai-close-btn">‚úï</button>
  </div>

  <div class="ai-chat-body" #aiChatBody>
    @for (msg of aiMessages(); track $index) {
    <div class="chat-message" [class.user]="msg.role === 'user'" [class.bot]="msg.role === 'bot'">
      @if (msg.role === 'bot') {
      <span class="chat-avatar">‚óà</span>
      }
      <div class="message-bubble">{{ msg.text }}</div>
    </div>
    }
    @if (isAITyping()) {
    <div class="chat-message bot">
      <span class="chat-avatar">‚óà</span>
      <div class="message-bubble typing-indicator">
        <span></span><span></span><span></span>
      </div>
    </div>
    }
  </div>

  <div class="ai-suggestions">
    <button (click)="sendAIMessage('Analyze current threat level')" id="ai-suggest-threats">Threat Level</button>
    <button (click)="sendAIMessage('Summarize latest incidents')" id="ai-suggest-incidents">Incidents</button>
    <button (click)="sendAIMessage('Check darknet activity')" id="ai-suggest-darknet">Darknet</button>
    <button (click)="sendAIMessage('Compliance status')" id="ai-suggest-compliance">Compliance</button>
  </div>

  <div class="ai-input-area">
    <input id="ai-input" type="text" #aiInput placeholder="Ask CyberSentinel AI..."
      (keyup.enter)="sendAIMessage(aiInput.value); aiInput.value = ''">
    <button class="send-btn" (click)="sendAIMessage(aiInput.value); aiInput.value = ''" id="ai-send-btn">‚Üë</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       TOAST NOTIFICATIONS
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="toast-container" aria-live="polite">
  @for (toast of toasts(); track toast.id) {
  <div class="toast" [class]="toast.type">
    <span class="toast-icon">{{ toast.icon }}</span>
    <span class="toast-message">{{ toast.message }}</span>
  </div>
  }
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PROFILE EDIT MODAL
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
@if (isProfileModalOpen()) {
<div class="modal-overlay active" (click)="toggleProfileModal()">
  <div class="modal-panel profile" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Edit Administrator Profile</h3>
      <button class="close-btn" (click)="toggleProfileModal()" id="profile-modal-close">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="profile-name">Full Name</label>
        <input id="profile-name" type="text" #nameInput [value]="adminProfile().name" placeholder="Enter name...">
      </div>
      <div class="form-group">
        <label for="profile-role">Professional Role</label>
        <input id="profile-role" type="text" #roleInput [value]="adminProfile().role"
          placeholder="e.g. Senior Security Analyst">
      </div>
      <div class="form-group">
        <label for="profile-dept">Department</label>
        <input id="profile-dept" type="text" #deptInput [value]="adminProfile().department"
          placeholder="e.g. SOC Team Alpha">
      </div>
      <div class="modal-actions">
        <button class="action-btn primary" style="flex:1"
          (click)="saveProfile(nameInput.value, roleInput.value, deptInput.value)" id="btn-save-profile">Save
          Changes</button>
        <button class="action-btn" style="flex:1" (click)="toggleProfileModal()" id="btn-cancel-profile">Cancel</button>
      </div>
    </div>
  </div>
</div>
}
}