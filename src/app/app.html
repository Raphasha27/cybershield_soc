<!-- Login Page -->
<div class="page active" *ngIf="activePage === 'loginPage'">
  <div class="auth-container">
    <div class="auth-box">
      <div class="logo">
        <h1>â˜• KDT Cafe</h1>
        <p>Pretoria West's Premier Internet Cafe</p>
      </div>

      <form (ngSubmit)="onLogin()">
        <div class="form-group">
          <label for="loginEmail">Email Address</label>
          <input type="email" id="loginEmail" [(ngModel)]="loginData.email" name="email" placeholder="Enter your email"
            required>
        </div>

        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" [(ngModel)]="loginData.password" name="password"
            placeholder="Enter your password" required>
        </div>

        <button type="submit" class="btn">Login</button>
      </form>

      <div class="mock-credentials">
        <h4>ğŸ” Demo Login Credentials</h4>
        <p><strong>Email:</strong> demo@kdtcafe.co.za</p>
        <p><strong>Password:</strong> demo123</p>
        <p style="margin-top: 10px; font-size: 0.85em; color: #888;">Use these credentials to explore the platform</p>
      </div>

      <div class="auth-footer">
        Don't have an account? <a href="#" (click)="$event.preventDefault(); showPage('registerPage')">Register here</a>
      </div>
    </div>
  </div>
</div>

<!-- Register Page -->
<div class="page active" *ngIf="activePage === 'registerPage'">
  <div class="auth-container">
    <div class="auth-box">
      <div class="logo">
        <h1>â˜• KDT Cafe</h1>
        <p>Create Your Account</p>
      </div>

      <form (ngSubmit)="onRegister()">
        <div class="form-group">
          <label for="registerName">Full Name</label>
          <input type="text" id="registerName" [(ngModel)]="registerData.name" name="name"
            placeholder="Enter your full name" required>
        </div>

        <div class="form-group">
          <label for="registerEmail">Email Address</label>
          <input type="email" id="registerEmail" [(ngModel)]="registerData.email" name="email"
            placeholder="Enter your email" required>
        </div>

        <div class="form-group">
          <label for="registerPhone">Phone Number</label>
          <input type="tel" id="registerPhone" [(ngModel)]="registerData.phone" name="phone"
            placeholder="Enter your phone number" required>
        </div>

        <div class="form-group">
          <label for="registerPassword">Password</label>
          <input type="password" id="registerPassword" [(ngModel)]="registerData.password" name="password"
            placeholder="Create a password" required>
        </div>

        <button type="submit" class="btn">Create Account</button>
      </form>

      <div class="auth-footer">
        Already have an account? <a href="#" (click)="$event.preventDefault(); showPage('loginPage')">Login here</a>
      </div>
    </div>
  </div>
</div>

<!-- Main Dashboard -->
<div class="page active" *ngIf="activePage === 'dashboardPage'">
  <div class="container">
    <div class="header">
      <h2>â˜• KDT Cafe Dashboard</h2>
      <div class="user-info">
        <div class="notification-bell"
          (click)="showAlert('Notifications:\n\nğŸ‰ New tournament starting this weekend!\nğŸ’° Your wallet was topped up\nğŸ You have 450 reward points', 'info')">
          ğŸ””
          <span class="notification-badge">3</span>
        </div>
        <div class="cart-icon" (click)="checkout()">
          ğŸ›’
          <span class="cart-count">{{cartItems.length}}</span>
        </div>
        <div class="user-avatar">{{currentUser?.name?.charAt(0)}}</div>
        <span>{{currentUser?.name}}</span>
        <button class="logout-btn" (click)="logout()">Logout</button>
      </div>
    </div>

    <div class="nav-tabs">
      <button class="nav-tab" [class.active]="activeTab === 'home'" (click)="switchTab('home')">ğŸ  Home</button>
      <button class="nav-tab" [class.active]="activeTab === 'booking'" (click)="switchTab('booking')">ğŸ“… Book
        Station</button>
      <button class="nav-tab" [class.active]="activeTab === 'mybookings'" (click)="switchTab('mybookings')">ğŸ“‹ My
        Bookings</button>
      <button class="nav-tab" [class.active]="activeTab === 'wallet'" (click)="switchTab('wallet')">ğŸ’° Wallet</button>
      <button class="nav-tab" [class.active]="activeTab === 'tournaments'" (click)="switchTab('tournaments')">ğŸ†
        Tournaments</button>
      <button class="nav-tab" [class.active]="activeTab === 'foodmenu'" (click)="switchTab('foodmenu')">ğŸ” Food &
        Drinks</button>
      <button class="nav-tab" [class.active]="activeTab === 'services'" (click)="switchTab('services')">âš™ï¸
        Services</button>
      <button class="nav-tab" [class.active]="activeTab === 'rewards'" (click)="switchTab('rewards')">ğŸ
        Rewards</button>
    </div>

    <!-- Home Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'home'">
      <div class="dashboard">
        <div class="card" (click)="switchTab('booking')">
          <div class="card-icon">ğŸ’»</div>
          <h3>Available Stations</h3>
          <p>High-performance PCs ready for you</p>
          <div class="stat">14/20</div>
        </div>

        <div class="card" (click)="switchTab('wallet')">
          <div class="card-icon">ğŸ’°</div>
          <h3>Wallet Balance</h3>
          <p>Your account balance</p>
          <div class="stat">R{{walletBalance}}</div>
        </div>

        <div class="card" (click)="switchTab('rewards')">
          <div class="card-icon">â­</div>
          <h3>Reward Points</h3>
          <p>Earn points with every visit</p>
          <div class="stat">{{rewardPoints}}</div>
        </div>

        <div class="card" (click)="switchTab('mybookings')">
          <div class="card-icon">ğŸ“…</div>
          <h3>Active Bookings</h3>
          <p>Your current reservations</p>
          <div class="stat">{{bookings.length}}</div>
        </div>
      </div>

      <div class="bookings-list">
        <h3>Welcome to KDT Cafe! ğŸ®</h3>
        <p style="color: #666; margin-top: 10px; line-height: 1.6;">
          Your premier gaming and internet cafe in Pretoria West. Whether you're here to game, work, study, or just hang
          out - we've got you covered with state-of-the-art facilities and a vibrant community.
        </p>
        <div style="margin-top: 25px; padding: 20px; background: #e0f7f4; border-radius: 10px;">
          <h4 style="color: #11998e; margin-bottom: 15px;">ğŸ†• What's New</h4>
          <ul style="list-style: none; padding: 0;">
            <li style="padding: 8px 0;">âœ¨ New gaming tournaments every weekend</li>
            <li style="padding: 8px 0;">ğŸ• Expanded food menu with fresh options</li>
            <li style="padding: 8px 0;">ğŸ Enhanced rewards program - earn points faster</li>
            <li style="padding: 8px 0;">ğŸ’³ Digital wallet for easy payments</li>
          </ul>
        </div>
        <div style="margin-top: 20px;">
          <p><strong>ğŸ“ Location:</strong> Pretoria West, South Africa</p>
          <p><strong>ğŸ•’ Hours:</strong> Mon-Sat 8:00 AM - 10:00 PM | Sun 10:00 AM - 8:00 PM</p>
          <p><strong>ğŸ“ Contact:</strong> +27 12 345 6789</p>
          <p><strong>ğŸ“§ Email:</strong> info@kdtcafe.co.za</p>
        </div>
      </div>
    </div>

    <!-- Booking Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'booking'">
      <div class="booking-form">
        <h3>Make a Booking</h3>
        <div *ngIf="bookingAlert" class="alert" [ngClass]="bookingAlert.type">
          {{bookingAlert.message}}
        </div>

        <form (ngSubmit)="confirmBooking()">
          <div class="form-row">
            <div class="form-group">
              <label for="bookingDate">Date</label>
              <input type="date" id="bookingDate" [(ngModel)]="bookingData.date" name="date" [min]="today" required>
            </div>

            <div class="form-group">
              <label for="bookingTime">Start Time</label>
              <input type="time" id="bookingTime" [(ngModel)]="bookingData.time" name="time" required>
            </div>

            <div class="form-group">
              <label for="bookingDuration">Duration</label>
              <select id="bookingDuration" [(ngModel)]="bookingData.duration" name="duration" required>
                <option value="">Select duration</option>
                <option value="1">1 Hour - R30</option>
                <option value="2">2 Hours - R55</option>
                <option value="3">3 Hours - R80</option>
                <option value="4">4 Hours - R100</option>
                <option value="8">Full Day - R180</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>Select Station (ğŸŸ¢ Available | ğŸ”´ Occupied)</label>
            <div class="station-grid">
              <button type="button" *ngFor="let station of stations" class="station-btn"
                [class.occupied]="station.occupied" [class.selected]="station.selected"
                (click)="selectStation(station.id)">
                PC {{station.id}}<br>
                <span *ngIf="station.occupied">ğŸ”´</span>
                <span *ngIf="!station.occupied && !station.selected">ğŸŸ¢</span>
                <span *ngIf="station.selected">âœ“</span>
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="bookingPurpose">Purpose</label>
            <select id="bookingPurpose" [(ngModel)]="bookingData.purpose" name="purpose" required>
              <option value="">Select purpose</option>
              <option value="gaming">Gaming</option>
              <option value="work">Work/Study</option>
              <option value="printing">Printing Services</option>
              <option value="browsing">Internet Browsing</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="bookingNotes">Special Requests (Optional)</label>
            <textarea id="bookingNotes" rows="3" [(ngModel)]="bookingData.notes" name="notes"
              placeholder="Any special requirements or notes..."></textarea>
          </div>

          <button type="submit" class="btn">Confirm Booking</button>
        </form>
      </div>
    </div>

    <!-- My Bookings Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'mybookings'">
      <div class="bookings-list">
        <h3>My Bookings</h3>
        <div *ngIf="bookings.length === 0">
          <p style="color: #666; text-align: center; padding: 40px;">No bookings yet. Make your first booking!</p>
        </div>
        <div *ngFor="let booking of bookings" class="booking-item">
          <div class="booking-details">
            <h4>PC {{booking.station}} - {{booking.purpose}}</h4>
            <p>ğŸ“… {{booking.date}} at {{booking.time}} | â±ï¸ {{booking.duration}} Hour(s) | ğŸ’° R{{booking.cost}}</p>
            <p *ngIf="booking.notes" style="font-style: italic; color: #888;">Note: {{booking.notes}}</p>
          </div>
          <div style="display: flex; gap: 10px; align-items: center;">
            <span class="status-badge" [ngClass]="booking.status">{{booking.status | uppercase}}</span>
            <button class="btn btn-small" (click)="cancelBooking(booking.id)"
              style="background: #ff4757;">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Wallet Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'wallet'">
      <div class="wallet-balance">
        <h3>Available Balance</h3>
        <div class="amount">R{{walletBalance.toFixed(2)}}</div>
        <div class="wallet-actions">
          <button class="btn btn-small" (click)="showTopUpModal()">ğŸ’³ Top Up</button>
          <button class="btn btn-small btn-secondary" (click)="showTransactionHistory()">ğŸ“Š History</button>
        </div>
      </div>

      <div class="bookings-list">
        <h3>Recent Transactions</h3>
        <div>
          <!-- Static Transactions for now as per user request example -->
          <div class="transaction-item">
            <div style="display: flex; align-items: center;">
              <div class="transaction-icon credit">+</div>
              <div class="transaction-info">
                <h4>Wallet Top-up</h4>
                <p style="color: #666; font-size: 0.9em;">Feb 15, 2026 - 14:30</p>
              </div>
            </div>
            <div class="transaction-amount credit">+R500.00</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tournaments Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'tournaments'">
      <h3 style="color: white; margin-bottom: 20px;">ğŸ† Gaming Tournaments</h3>

      <div class="tournament-card">
        <div class="tournament-header">
          <div>
            <h3>FIFA 24 Championship</h3>
            <p style="color: #666;">This Weekend's Big Event!</p>
          </div>
          <span class="tournament-badge open">OPEN</span>
        </div>
        <p style="color: #666; margin-bottom: 15px;">
          Join our exciting FIFA tournament. 1v1 knockout format with amazing prizes!
        </p>
        <div class="tournament-info">
          <div class="tournament-stat">
            <div class="label">Prize Pool</div>
            <div class="value">R2,000</div>
          </div>
          <div class="tournament-stat">
            <div class="label">Entry Fee</div>
            <div class="value">R50</div>
          </div>
          <div class="tournament-stat">
            <div class="label">Players</div>
            <div class="value">12/16</div>
          </div>
          <div class="tournament-stat">
            <div class="label">Date</div>
            <div class="value">Feb 20</div>
          </div>
        </div>
        <button class="btn" style="margin-top: 15px;" (click)="registerTournament('FIFA 24')">Register Now</button>
      </div>
    </div>

    <!-- Food Menu Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'foodmenu'">
      <div class="bookings-list">
        <h3>Food & Drinks Menu ğŸ”</h3>
        <p style="color: #666; margin-bottom: 20px;">Order food directly to your station!</p>

        <div class="menu-categories">
          <button class="category-btn" [class.active]="activeCategory === 'all'" (click)="filterMenu('all')">All
            Items</button>
          <button class="category-btn" [class.active]="activeCategory === 'meals'"
            (click)="filterMenu('meals')">Meals</button>
          <button class="category-btn" [class.active]="activeCategory === 'snacks'"
            (click)="filterMenu('snacks')">Snacks</button>
          <button class="category-btn" [class.active]="activeCategory === 'drinks'"
            (click)="filterMenu('drinks')">Drinks</button>
        </div>

        <div>
          <!-- Static Menu Items -->
          <div class="menu-item" *ngIf="activeCategory === 'all' || activeCategory === 'meals'">
            <div class="menu-item-image">ğŸ”</div>
            <div class="menu-item-details">
              <h4>Gamer Burger Combo</h4>
              <p>Double beef patty, cheese, fries & drink</p>
              <span class="menu-item-price">R85</span>
            </div>
            <button class="add-to-cart" (click)="addToCart('Gamer Burger Combo', 85)">Add to Cart</button>
          </div>

          <div class="menu-item" *ngIf="activeCategory === 'all' || activeCategory === 'drinks'">
            <div class="menu-item-image">ğŸ¥¤</div>
            <div class="menu-item-details">
              <h4>Soft Drink</h4>
              <p>Coke, Sprite, Fanta - 500ml</p>
              <span class="menu-item-price">R18</span>
            </div>
            <button class="add-to-cart" (click)="addToCart('Soft Drink', 18)">Add to Cart</button>
          </div>
          <!-- Add more items as needed -->
        </div>
      </div>
    </div>

    <!-- Services Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'services'">
      <div class="services-grid">
        <div class="service-card">
          <h4>ğŸ’» Standard PC</h4>
          <div class="price">R30/hour</div>
          <ul>
            <li>High-speed internet</li>
            <li>Office applications</li>
            <li>Web browsing</li>
            <li>Email access</li>
            <li>Free printing (5 pages)</li>
          </ul>
          <button class="btn" (click)="switchTab('booking')">Book Now</button>
        </div>
        <div class="service-card">
          <h4>ğŸ® Gaming Station</h4>
          <div class="price">R50/hour</div>
          <ul>
            <li>High-end gaming PC</li>
            <li>Latest games installed</li>
            <li>Gaming peripherals</li>
            <li>Discord & voice chat</li>
            <li>144Hz monitors</li>
          </ul>
          <button class="btn" (click)="switchTab('booking')">Book Now</button>
        </div>
      </div>
    </div>

    <!-- Rewards Tab -->
    <div class="tab-content active" *ngIf="activeTab === 'rewards'">
      <div class="rewards-level">
        <div class="level-badge">â­</div>
        <h3>Silver Member</h3>
        <p>You have <strong>{{rewardPoints}}</strong> points</p>
        <div class="points-bar">
          <div class="points-progress" [style.width.%]="(rewardPoints/1000)*100">
            {{rewardPoints}}/1000 to Gold
          </div>
        </div>
        <p style="opacity: 0.9; font-size: 0.9em;">{{1000 - rewardPoints}} more points to reach Gold status!</p>
      </div>

      <div class="bookings-list">
        <h3>Available Rewards</h3>

        <div class="reward-item">
          <div>
            <h4>ğŸ Free 1 Hour Gaming</h4>
            <p style="color: #666; font-size: 0.9em;">Redeem for 1 hour of free gaming time</p>
          </div>
          <div style="text-align: right;">
            <div style="font-weight: bold; color: #11998e; margin-bottom: 5px;">200 points</div>
            <button class="btn btn-small" (click)="redeemReward('Free 1 Hour Gaming', 200)">Redeem</button>
          </div>
        </div>
        <div class="reward-item">
          <div>
            <h4>ğŸ’° R50 Wallet Credit</h4>
            <p style="color: #666; font-size: 0.9em;">Add R50 to your wallet</p>
          </div>
          <div style="text-align: right;">
            <div style="font-weight: bold; color: #11998e; margin-bottom: 5px;">300 points</div>
            <button class="btn btn-small" (click)="redeemReward('R50 Wallet Credit', 300)">Redeem</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Chat Widget -->
<div class="chat-widget">
  <button class="chat-button" (click)="toggleChat()">ğŸ’¬</button>
  <div class="chat-window" [class.active]="isChatActive">
    <div class="chat-header">
      <h4>Live Support</h4>
      <span style="cursor: pointer;" (click)="toggleChat()">âœ•</span>
    </div>
    <div class="chat-messages">
      <div *ngFor="let msg of chatMessages" class="chat-message" [ngClass]="msg.role">
        <strong *ngIf="msg.role === 'staff'">KDT Support</strong>
        <strong *ngIf="msg.role === 'user'">You</strong><br>
        {{msg.text}}
      </div>
    </div>
    <div class="chat-input">
      <input type="text" [(ngModel)]="chatInput" (keyup.enter)="sendMessage()" placeholder="Type a message...">
      <button (click)="sendMessage()">Send</button>
    </div>
  </div>
</div>

<!-- Top Up Modal -->
<div class="modal" [class.active]="isTopUpModalActive">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Top Up Wallet</h3>
      <span class="close-modal" (click)="closeModal('topUpModal')">âœ•</span>
    </div>
    <form (ngSubmit)="completeTopUp()">
      <div class="form-group">
        <label>Select Amount</label>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px;">
          <button type="button" class="btn btn-secondary btn-small" (click)="setTopUpAmount(50)">R50</button>
          <button type="button" class="btn btn-secondary btn-small" (click)="setTopUpAmount(100)">R100</button>
          <button type="button" class="btn btn-secondary btn-small" (click)="setTopUpAmount(200)">R200</button>
          <button type="button" class="btn btn-secondary btn-small" (click)="setTopUpAmount(500)">R500</button>
          <button type="button" class="btn btn-secondary btn-small" (click)="setTopUpAmount(1000)">R1000</button>
        </div>
      </div>
      <div class="form-group">
        <label for="customAmount">Or Enter Custom Amount</label>
        <input type="number" id="customAmount" [(ngModel)]="topUpAmount" name="customAmount" placeholder="Enter amount"
          min="10">
      </div>
      <div class="form-group">
        <label for="paymentMethod">Payment Method</label>
        <select id="paymentMethod" [(ngModel)]="paymentMethod" name="paymentMethod" required>
          <option value="">Select payment method</option>
          <option value="card">Credit/Debit Card</option>
          <option value="eft">EFT</option>
          <option value="cash">Cash (Pay at counter)</option>
        </select>
      </div>
      <button type="submit" class="btn">Complete Top Up</button>
    </form>
  </div>
</div>